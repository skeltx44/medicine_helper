<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=360, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>이달의 약</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="thismonth.css">
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <header class="header">
            <div class="header-top">
                <a href="main.html" class="back-button">
                    <span class="arrow">←</span>
                    <span class="back-text">뒤로가기</span>
                </a>
                <div class="app-title">
                    <span class="app-title-text"><span class="app-title-med">약</span><span class="app-title-rest">을먹자</span></span>
                    <img src="pill.png" class="pill-icon" alt="알약">
                </div>
            </div>
            <h1 class="main-title">이달의 약</h1>
        </header>

        <!-- Main Content Section -->
        <main class="main-content">
            <div class="calendar-container">
                <div class="calendar-header">
                    <div class="month-year" id="monthYear"></div>
                </div>
                <div class="calendar-weekdays">
                    <div class="weekday">일</div>
                    <div class="weekday">월</div>
                    <div class="weekday">화</div>
                    <div class="weekday">수</div>
                    <div class="weekday">목</div>
                    <div class="weekday">금</div>
                    <div class="weekday">토</div>
                </div>
                <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar days will be generated by JavaScript -->
                </div>
            </div>
        </main>
    </div>

    <script>
        // 현재 날짜 가져오기
        const now = new Date();
        let currentYear = now.getFullYear();
        let currentMonth = now.getMonth();

        // 달력 생성 함수
        function generateCalendar(year, month) {
            const monthYearElement = document.getElementById('monthYear');
            const calendarGrid = document.getElementById('calendarGrid');
            
            // 월/년도 표시
            monthYearElement.textContent = `${year}.${String(month + 1).padStart(2, '0')}`;
            
            // 달력 그리드 초기화
            calendarGrid.innerHTML = '';
            
            // 해당 월의 첫 번째 날과 마지막 날
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = firstDay.getDay();
            
            // 이전 달의 마지막 날들 (빈 칸 채우기)
            const prevMonthLastDay = new Date(year, month, 0).getDate();
            for (let i = startingDayOfWeek - 1; i >= 0; i--) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = prevMonthLastDay - i;
                dayElement.appendChild(dayNumber);
                
                const dayContent = document.createElement('div');
                dayContent.className = 'day-content';
                dayElement.appendChild(dayContent);
                
                calendarGrid.appendChild(dayElement);
            }
            
            // 현재 달의 날들
            const today = new Date();
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                // 오늘 날짜 체크
                if (year === today.getFullYear() && month === today.getMonth() && day === today.getDate()) {
                    dayElement.classList.add('today');
                }
                
                // 일요일 체크
                const dayOfWeek = new Date(year, month, day).getDay();
                if (dayOfWeek === 0) {
                    dayElement.classList.add('sunday');
                }
                
                // 일수 표시
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = day;
                dayElement.appendChild(dayNumber);
                
                // 날짜 내용 영역 (OX 표시 포함)
                const dayContent = document.createElement('div');
                dayContent.className = 'day-content';
                dayElement.appendChild(dayContent);
                
                // OX 표시 영역
                const markContainer = document.createElement('div');
                markContainer.className = 'day-mark';
                dayContent.appendChild(markContainer);
                
                // 클릭 이벤트: 홀수일은 초록색 O, 짝수일은 빨간색 X (토글 기능)
                (function(dayEl, markEl, dayValue) {
                    dayEl.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        
                        if (dayEl.classList.contains('other-month')) {
                            return;
                        }
                        
                        const existingMark = markEl.querySelector('.mark-circle, .mark-cross');
                        
                        if (existingMark) {
                            markEl.innerHTML = '';
                        } else {
                            if (dayValue % 2 === 1) {
                                const circleMark = document.createElement('div');
                                circleMark.className = 'mark-circle';
                                circleMark.textContent = '○';
                                circleMark.style.fontSize = '28px';
                                circleMark.style.color = '#4CAF50';
                                circleMark.style.fontWeight = '900';
                                circleMark.style.textAlign = 'center';
                                circleMark.style.lineHeight = '1';
                                circleMark.style.display = 'block';
                                circleMark.style.width = '100%';
                                circleMark.style.margin = '0';
                                circleMark.style.padding = '0';
                                circleMark.style.webkitTextStroke = '1px #4CAF50';
                                circleMark.style.textStroke = '1px #4CAF50';
                                markEl.appendChild(circleMark);
                            } else {
                                const crossMark = document.createElement('div');
                                crossMark.className = 'mark-cross';
                                crossMark.textContent = '✕';
                                crossMark.style.fontSize = '26px';
                                crossMark.style.color = '#f44336';
                                crossMark.style.fontWeight = 'bold';
                                crossMark.style.textAlign = 'center';
                                crossMark.style.lineHeight = '1';
                                crossMark.style.display = 'block';
                                crossMark.style.width = '100%';
                                crossMark.style.margin = '0';
                                crossMark.style.padding = '0';
                                crossMark.style.webkitTextStroke = '1px #f44336';
                                crossMark.style.textStroke = '1px #f44336';
                                markEl.appendChild(crossMark);
                            }
                        }
                    });
                })(dayElement, markContainer, day);
                
                calendarGrid.appendChild(dayElement);
            }
            
            // 다음 달의 첫 날들 (빈 칸 채우기)
            const totalCells = calendarGrid.children.length;
            const remainingCells = 42 - totalCells; // 6주 * 7일 = 42
            for (let day = 1; day <= remainingCells; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day other-month';
                
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = day;
                dayElement.appendChild(dayNumber);
                
                const dayContent = document.createElement('div');
                dayContent.className = 'day-content';
                dayElement.appendChild(dayContent);
                
                calendarGrid.appendChild(dayElement);
            }
        }
        
        // 페이지 로드 시 달력 생성
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                generateCalendar(currentYear, currentMonth);
            });
        } else {
            generateCalendar(currentYear, currentMonth);
        }
    </script>
</body>
</html>

